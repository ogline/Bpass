<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PDF Boarding Pass Generator</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcode-generator/1.4.4/qrcode.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #1e3c72, #2a5298);
            color: #333;
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        header {
            text-align: center;
            margin-bottom: 30px;
            color: white;
            padding: 20px;
        }
        
        h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
        }
        
        .subtitle {
            font-size: 1.2rem;
            opacity: 0.9;
        }
        
        .card {
            background: white;
            border-radius: 10px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            overflow: hidden;
            margin-bottom: 30px;
        }
        
        .card-header {
            background: #2c3e50;
            color: white;
            padding: 15px 20px;
            font-size: 1.3rem;
        }
        
        .form-container {
            padding: 30px;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #2c3e50;
        }
        
        select, input {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 16px;
            transition: border 0.3s;
        }
        
        select:focus, input:focus {
            border-color: #3498db;
            outline: none;
            box-shadow: 0 0 0 2px rgba(52, 152, 219, 0.2);
        }
        
        .row {
            display: flex;
            flex-wrap: wrap;
            margin: 0 -10px;
        }
        
        .col {
            flex: 1;
            padding: 0 10px;
            min-width: 200px;
        }
        
        .btn {
            display: inline-block;
            background: #3498db;
            color: white;
            border: none;
            padding: 12px 25px;
            font-size: 16px;
            border-radius: 5px;
            cursor: pointer;
            transition: background 0.3s;
            font-weight: 600;
        }
        
        .btn:hover {
            background: #2980b9;
        }
        
        .btn-pdf {
            background: #e74c3c;
        }
        
        .btn-pdf:hover {
            background: #c0392b;
        }
        
        .btn-reset {
            background: #95a5a6;
        }
        
        .btn-reset:hover {
            background: #7f8c8d;
        }
        
        .button-group {
            display: flex;
            gap: 15px;
            margin-top: 30px;
            justify-content: center;
        }
        
        .preview-section {
            background: white;
            border-radius: 10px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            padding: 30px;
            margin-top: 30px;
        }
        
        .preview-header {
            text-align: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid #3498db;
        }
        
        .boarding-pass {
            width: 100%;
            max-width: 400px;
            margin: 0 auto;
            border: 2px solid #2c3e50;
            border-radius: 15px;
            overflow: hidden;
            background: linear-gradient(135deg, #005a9e, #0077b6);
            color: white;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        }
        
        .pass-header {
            background: #2c3e50;
            padding: 20px;
            text-align: center;
            border-bottom: 2px solid rgba(255,255,255,0.2);
        }
        
        .airline-logo {
            font-size: 28px;
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .pass-content {
            padding: 25px;
        }
        
        .flight-info {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            background: rgba(255, 255, 255, 0.1);
            padding: 20px;
            border-radius: 10px;
        }
        
        .airport {
            text-align: center;
            flex: 1;
        }
        
        .airport-code {
            font-size: 42px;
            font-weight: bold;
            margin-bottom: 8px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }
        
        .airport-city {
            font-size: 16px;
            margin-bottom: 5px;
            font-weight: 600;
        }
        
        .airport-label {
            font-size: 12px;
            opacity: 0.8;
        }
        
        .flight-arrow {
            font-size: 36px;
            margin: 0 20px;
            opacity: 0.9;
        }
        
        .flight-number {
            text-align: center;
            margin-top: 10px;
        }
        
        .passenger-info {
            background: rgba(255, 255, 255, 0.15);
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 25px;
            border-left: 4px solid #e74c3c;
        }
        
        .passenger-name {
            font-size: 22px;
            font-weight: bold;
            margin-bottom: 10px;
        }
        
        .details-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
            margin-bottom: 25px;
        }
        
        .detail-item {
            background: rgba(255, 255, 255, 0.1);
            padding: 15px;
            border-radius: 8px;
            text-align: center;
            border: 1px solid rgba(255,255,255,0.2);
        }
        
        .detail-label {
            font-size: 12px;
            opacity: 0.8;
            margin-bottom: 8px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .detail-value {
            font-size: 18px;
            font-weight: bold;
        }
        
        .ticket-info {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 25px;
        }
        
        .ticket-item {
            background: rgba(255, 255, 255, 0.1);
            padding: 15px;
            border-radius: 8px;
            text-align: center;
        }
        
        .barcode-section {
            text-align: center;
            padding: 20px;
            background: rgba(255, 255, 255, 0.95);
            margin: 0 -25px -25px -25px;
            border-top: 2px solid #2c3e50;
        }
        
        .barcode-text {
            color: #2c3e50;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            margin-top: 10px;
            font-weight: bold;
        }
        
        #qrcode {
            display: inline-block;
            padding: 10px;
            background: white;
            border-radius: 8px;
            border: 2px solid #2c3e50;
        }
        
        #qrcode img {
            display: block;
            margin: 0 auto;
        }
        
        @media (max-width: 768px) {
            .row {
                flex-direction: column;
            }
            
            .col {
                margin-bottom: 15px;
            }
            
            .details-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .ticket-info {
                grid-template-columns: 1fr;
            }
            
            .flight-info {
                flex-direction: column;
                text-align: center;
            }
            
            .flight-arrow {
                margin: 15px 0;
                transform: rotate(90deg);
            }
            
            .boarding-pass {
                max-width: 100%;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>PDF Boarding Pass Generator</h1>
            <p class="subtitle">Generate professional boarding passes for Saudi Arabia to India flights</p>
        </header>
        
        <div class="card">
            <div class="card-header">
                Flight Details
            </div>
            <div class="form-container">
                <form id="flightForm">
                    <div class="row">
                        <div class="col">
                            <div class="form-group">
                                <label for="departure">Departure City (Saudi Arabia)</label>
                                <select id="departure" required>
                                    <option value="">Select departure city</option>
                                    <option value="JED">Jeddah - King Abdulaziz (JED)</option>
                                    <option value="RUH">Riyadh - King Khalid (RUH)</option>
                                    <option value="DMM">Dammam - King Fahd (DMM)</option>
                                    <option value="MED">Medina - Prince Mohammad Bin Abdulaziz (MED)</option>
                                </select>
                            </div>
                        </div>
                        <div class="col">
                            <div class="form-group">
                                <label for="arrival">Arrival City (India)</label>
                                <select id="arrival" required>
                                    <option value="">Select arrival city</option>
                                    <option value="DEL">Delhi - Indira Gandhi (DEL)</option>
                                    <option value="BOM">Mumbai - Chhatrapati Shivaji (BOM)</option>
                                    <option value="BLR">Bangalore - Kempegowda (BLR)</option>
                                    <option value="MAA">Chennai - Chennai International (MAA)</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    
                    <div class="row">
                        <div class="col">
                            <div class="form-group">
                                <label for="airline">Airline</label>
                                <select id="airline" required>
                                    <option value="">Select airline</option>
                                    <option value="SV">Saudia (SV)</option>
                                    <option value="XY">Flynas (XY)</option>
                                    <option value="6E">IndiGo (6E)</option>
                                    <option value="AI">Air India (AI)</option>
                                </select>
                            </div>
                        </div>
                        <div class="col">
                            <div class="form-group">
                                <label for="flightNumber">Flight Number</label>
                                <input type="text" id="flightNumber" placeholder="e.g., SV2501" required>
                            </div>
                        </div>
                    </div>
                    
                    <div class="row">
                        <div class="col">
                            <div class="form-group">
                                <label for="departureDate">Departure Date</label>
                                <input type="date" id="departureDate" required>
                            </div>
                        </div>
                        <div class="col">
                            <div class="form-group">
                                <label for="departureTime">Departure Time</label>
                                <input type="time" id="departureTime" required>
                            </div>
                        </div>
                    </div>
                    
                    <div class="row">
                        <div class="col">
                            <div class="form-group">
                                <label for="passengerName">Passenger Name</label>
                                <input type="text" id="passengerName" placeholder="Enter full name" required>
                            </div>
                        </div>
                        <div class="col">
                            <div class="form-group">
                                <label for="seatNumber">Seat Number</label>
                                <input type="text" id="seatNumber" placeholder="e.g., 12A" required>
                            </div>
                        </div>
                    </div>
                    
                    <div class="row">
                        <div class="col">
                            <div class="form-group">
                                <label for="airlinePNR">Airline PNR</label>
                                <input type="text" id="airlinePNR" placeholder="e.g., ABC123" required>
                            </div>
                        </div>
                        <div class="col">
                            <div class="form-group">
                                <label for="ticketNumber">Ticket Number</label>
                                <input type="text" id="ticketNumber" placeholder="e.g., 1234567890123" required>
                            </div>
                        </div>
                    </div>
                    
                    <div class="row">
                        <div class="col">
                            <div class="form-group">
                                <label for="gate">Gate</label>
                                <input type="text" id="gate" placeholder="e.g., B12" required>
                            </div>
                        </div>
                        <div class="col">
                            <div class="form-group">
                                <label for="boardingTime">Boarding Time</label>
                                <input type="time" id="boardingTime" required>
                            </div>
                        </div>
                    </div>
                    
                    <div class="button-group">
                        <button type="button" class="btn" id="previewBtn">Preview Boarding Pass</button>
                        <button type="button" class="btn btn-pdf" id="generatePdfBtn">Generate PDF</button>
                        <button type="reset" class="btn btn-reset" id="resetBtn">Reset Form</button>
                    </div>
                </form>
            </div>
        </div>
        
        <div class="preview-section" id="previewSection" style="display: none;">
            <div class="preview-header">
                <h2>Boarding Pass Preview</h2>
                <p>Review your boarding pass before generating PDF</p>
            </div>
            
            <div class="boarding-pass" id="boardingPassPreview">
                <!-- Preview will be generated here -->
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const { jsPDF } = window.jspdf;
            
            // Set default date to today
            const today = new Date();
            const formattedDate = today.toISOString().split('T')[0];
            document.getElementById('departureDate').value = formattedDate;
            
            // Set default times
            document.getElementById('departureTime').value = '14:30';
            document.getElementById('boardingTime').value = '13:45';
            
            // Set default PNR and Ticket Number
            document.getElementById('airlinePNR').value = 'ABC123';
            document.getElementById('ticketNumber').value = '1234567890123';
            
            // Airport data
            const airports = {
                'JED': { city: 'JEDDAH', name: 'King Abdulaziz International' },
                'RUH': { city: 'RIYADH', name: 'King Khalid International' },
                'DMM': { city: 'DAMMAM', name: 'King Fahd International' },
                'MED': { city: 'MEDINA', name: 'Prince Mohammad Bin Abdulaziz' },
                'DEL': { city: 'DELHI', name: 'Indira Gandhi International' },
                'BOM': { city: 'MUMBAI', name: 'Chhatrapati Shivaji International' },
                'BLR': { city: 'BANGALORE', name: 'Kempegowda International' },
                'MAA': { city: 'CHENNAI', name: 'Chennai International' }
            };
            
            // Airline data
            const airlines = {
                'SV': { name: 'SAUDIA', code: 'SV' },
                'XY': { name: 'FLYNAS', code: 'XY' },
                '6E': { name: 'INDIGO', code: '6E' },
                'AI': { name: 'AIR INDIA', code: 'AI' }
            };
            
            // Format date for display
            function formatDate(dateStr) {
                const date = new Date(dateStr);
                const months = ['JAN', 'FEB', 'MAR', 'APR', 'MAY', 'JUN', 'JUL', 'AUG', 'SEP', 'OCT', 'NOV', 'DEC'];
                const days = ['SUN', 'MON', 'TUE', 'WED', 'THU', 'FRI', 'SAT'];
                return `${days[date.getDay()]} ${date.getDate()} ${months[date.getMonth()]}`;
            }
            
            // Format time for display
            function formatTime(timeStr) {
                const [hours, minutes] = timeStr.split(':');
                const hour = parseInt(hours);
                const ampm = hour >= 12 ? 'PM' : 'AM';
                const displayHour = hour % 12 || 12;
                return `${displayHour}:${minutes} ${ampm}`;
            }
            
            // Generate QR Code
            function generateQRCode(text, elementId) {
                const typeNumber = 0;
                const errorCorrectionLevel = 'L';
                const qr = qrcode(typeNumber, errorCorrectionLevel);
                qr.addData(text);
                qr.make();
                
                const qrElement = document.getElementById(elementId);
                qrElement.innerHTML = qr.createImgTag(4);
            }
            
            // Generate boarding pass preview
            function generateBoardingPassPreview() {
                const departure = document.getElementById('departure').value;
                const arrival = document.getElementById('arrival').value;
                const airline = document.getElementById('airline').value;
                const flightNumber = document.getElementById('flightNumber').value;
                const departureDate = document.getElementById('departureDate').value;
                const departureTime = document.getElementById('departureTime').value;
                const passengerName = document.getElementById('passengerName').value;
                const seatNumber = document.getElementById('seatNumber').value;
                const gate = document.getElementById('gate').value;
                const boardingTime = document.getElementById('boardingTime').value;
                const airlinePNR = document.getElementById('airlinePNR').value;
                const ticketNumber = document.getElementById('ticketNumber').value;
                
                if (!departure || !arrival || !airline || !flightNumber) {
                    alert('Please fill in all required fields');
                    return;
                }
                
                const airlineInfo = airlines[airline];
                const departureInfo = airports[departure];
                const arrivalInfo = airports[arrival];
                
                // Generate barcode data
                const barcodeData = `M1${passengerName.toUpperCase().replace(/ /g, '/')} ${airlineInfo.code}${flightNumber} ${seatNumber} ${departure}${arrival}`;
                
                const previewHTML = `
                    <div class="pass-header">
                        <div class="airline-logo">${airlineInfo.name}</div>
                        <div>BOARDING PASS</div>
                    </div>
                    <div class="pass-content">
                        <div class="flight-info">
                            <div class="airport">
                                <div class="airport-code">${departure}</div>
                                <div class="airport-city">${departureInfo.city}</div>
                                <div class="airport-label">DEPARTURE</div>
                            </div>
                            <div class="flight-arrow">→</div>
                            <div class="airport">
                                <div class="airport-code">${arrival}</div>
                                <div class="airport-city">${arrivalInfo.city}</div>
                                <div class="airport-label">ARRIVAL</div>
                            </div>
                        </div>
                        <div class="flight-number">
                            <div class="detail-label">FLIGHT NUMBER</div>
                            <div class="detail-value">${airlineInfo.code}${flightNumber}</div>
                        </div>
                        
                        <div class="passenger-info">
                            <div class="detail-label">PASSENGER NAME</div>
                            <div class="passenger-name">${passengerName.toUpperCase()}</div>
                        </div>
                        
                        <div class="details-grid">
                            <div class="detail-item">
                                <div class="detail-label">DATE</div>
                                <div class="detail-value">${formatDate(departureDate)}</div>
                            </div>
                            <div class="detail-item">
                                <div class="detail-label">DEPARTURE TIME</div>
                                <div class="detail-value">${formatTime(departureTime)}</div>
                            </div>
                            <div class="detail-item">
                                <div class="detail-label">SEAT</div>
                                <div class="detail-value">${seatNumber}</div>
                            </div>
                            <div class="detail-item">
                                <div class="detail-label">GATE</div>
                                <div class="detail-value">${gate}</div>
                            </div>
                            <div class="detail-item">
                                <div class="detail-label">BOARDING TIME</div>
                                <div class="detail-value">${formatTime(boardingTime)}</div>
                            </div>
                            <div class="detail-item">
                                <div class="detail-label">CLASS</div>
                                <div class="detail-value">ECONOMY</div>
                            </div>
                        </div>
                        
                        <div class="ticket-info">
                            <div class="ticket-item">
                                <div class="detail-label">AIRLINE PNR</div>
                                <div class="detail-value">${airlinePNR}</div>
                            </div>
                            <div class="ticket-item">
                                <div class="detail-label">TICKET NUMBER</div>
                                <div class="detail-value">${ticketNumber}</div>
                            </div>
                        </div>
                        
                        <div class="barcode-section">
                            <div style="color: #2c3e50; font-weight: bold; margin-bottom: 10px;">SCAN AT GATE</div>
                            <div id="qrcode"></div>
                            <div class="barcode-text">${barcodeData}</div>
                        </div>
                    </div>
                `;
                
                document.getElementById('boardingPassPreview').innerHTML = previewHTML;
                document.getElementById('previewSection').style.display = 'block';
                
                // Generate QR code
                generateQRCode(barcodeData, 'qrcode');
            }
            
            // Generate PDF with proper sizing
            async function generatePDF() {
                const departure = document.getElementById('departure').value;
                const arrival = document.getElementById('arrival').value;
                const airline = document.getElementById('airline').value;
                const flightNumber = document.getElementById('flightNumber').value;
                const passengerName = document.getElementById('passengerName').value;
                
                if (!departure || !arrival || !airline || !flightNumber) {
                    alert('Please fill in all required fields first');
                    return;
                }
                
                // First generate the preview to ensure we have the latest data
                generateBoardingPassPreview();
                
                // Wait a moment for the preview to render
                await new Promise(resolve => setTimeout(resolve, 500));
                
                // Capture the boarding pass element
                const element = document.getElementById('boardingPassPreview');
                
                try {
                    const canvas = await html2canvas(element, {
                        scale: 2, // Higher quality
                        useCORS: true,
                        logging: false,
                        backgroundColor: null,
                        width: element.offsetWidth,
                        height: element.offsetHeight
                    });
                    
                    const imgData = canvas.toDataURL('image/png');
                    
                    // Create PDF with proper sizing
                    const doc = new jsPDF({
                        orientation: 'portrait',
                        unit: 'mm',
                        format: 'a4'
                    });
                    
                    // Calculate dimensions to fit the boarding pass properly on A4
                    const pdfWidth = doc.internal.pageSize.getWidth();
                    const pdfHeight = doc.internal.pageSize.getHeight();
                    
                    // Boarding pass dimensions (maintain aspect ratio)
                    const boardingPassWidth = 85; // Standard boarding pass width in mm
                    const boardingPassHeight = (canvas.height * boardingPassWidth) / canvas.width;
                    
                    // Center the boarding pass on the page
                    const x = (pdfWidth - boardingPassWidth) / 2;
                    const y = (pdfHeight - boardingPassHeight) / 2;
                    
                    // Add the image to PDF with proper sizing
                    doc.addImage(imgData, 'PNG', x, y, boardingPassWidth, boardingPassHeight);
                    
                    // Add footer with generation info
                    doc.setFontSize(10);
                    doc.setTextColor(100);
                    doc.text(`Generated by ALMATAR.COM - ${new Date().toLocaleString()}`, pdfWidth / 2, pdfHeight - 10, { align: 'center' });
                    
                    // Save PDF
                    doc.save(`boarding-pass-${airline}${flightNumber}-${passengerName.replace(/ /g, '-')}.pdf`);
                    
                } catch (error) {
                    console.error('Error generating PDF:', error);
                    alert('Error generating PDF. Please try again.');
                }
            }
            
            // Event listeners
            document.getElementById('previewBtn').addEventListener('click', generateBoardingPassPreview);
            document.getElementById('generatePdfBtn').addEventListener('click', generatePDF);
            document.getElementById('resetBtn').addEventListener('click', function() {
                document.getElementById('previewSection').style.display = 'none';
            });
        });
    </script>
</body>
</html>